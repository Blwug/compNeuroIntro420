<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2021-12-27 Mon 14:22 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Models of Spiking Neurons and Differential Equations</title>
<meta name="author" content="Britt Anderson" />
<meta name="generator" content="Org Mode" />
<style>
  #content { max-width: 60em; margin: auto; }
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #e6e6e6;
    border-radius: 3px;
    background-color: #f2f2f2;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: auto;
  }
  pre.src:before {
    display: none;
    position: absolute;
    top: -8px;
    right: 12px;
    padding: 3px;
    color: #555;
    background-color: #f2f2f299;
  }
  pre.src:hover:before { display: inline; margin-top: 14px;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-authinfo::before { content: 'Authinfo'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .equation-container {
    display: table;
    text-align: center;
    width: 100%;
  }
  .equation {
    vertical-align: middle;
  }
  .equation-label {
    display: table-cell;
    text-align: right;
    vertical-align: middle;
  }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { width: 90%; }
</style>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        displayAlign: "center",
        displayIndent: "0em",

        "HTML-CSS": { scale: 100,
                        linebreaks: { automatic: "false" },
                        webFont: "TeX"
                       },
        SVG: {scale: 100,
              linebreaks: { automatic: "false" },
              font: "TeX"},
        NativeMML: {scale: 100},
        TeX: { equationNumbers: {autoNumber: "AMS"},
               MultLineWidth: "85%",
               TagSide: "right",
               TagIndent: ".8em"
             }
});
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS_HTML"></script>
</head>
<body>
<div id="content" class="content">
<h1 class="title">Models of Spiking Neurons and Differential Equations</h1>
<div id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="#orgdb1d861">1. An Introduction to Differential Equations</a>
<ul>
<li><a href="#orge390b34">1.1. Why are Differential Equations an important technique for computational modelling in psychology and neuroscience?</a>
<ul>
<li><a href="#orga3aca2d">1.1.1. The Action Potential&#xa0;&#xa0;&#xa0;<span class="tag"><span class="class_exercise">class_exercise</span></span></a></li>
<li><a href="#orgf183b67">1.1.2. Why is the action potential relevant for a discussion of DE's in modelling?</a></li>
</ul>
</li>
<li><a href="#org267e055">1.2. Notation</a>
<ul>
<li><a href="#org997c23a">1.2.1. Multiple Ways to Say the Same Thing</a></li>
</ul>
</li>
<li><a href="#org00ef11a">1.3. Differential Equations - Equations with Derivatives</a>
<ul>
<li><a href="#org9f43a0b">1.3.1. What is a differential equation?</a></li>
<li><a href="#org378aa28">1.3.2. What is a derivative?</a></li>
<li><a href="#orgb01c940">1.3.3. Derivatives are Slopes</a></li>
<li><a href="#org62ae167">1.3.4. Digression: Use your computer as a tool for exploration</a></li>
<li><a href="#orga5ebfca">1.3.5. What is the Slope of a Curve?</a></li>
<li><a href="#org139697d">1.3.6. Thinking About Slopes</a></li>
<li><a href="#org78044bc">1.3.7. How do you find the slope of a <i>curve</i>?</a></li>
</ul>
</li>
<li><a href="#org41404c0">1.4. Derivatives are Instantaneous Slopes</a>
<ul>
<li><a href="#derivative">1.4.1. Definition of the Derivative:</a></li>
<li><a href="#orgb1ece74">1.4.2. Digression: Writing Math in Documents</a></li>
</ul>
</li>
<li><a href="#orgc4ffdc6">1.5. Homework&#xa0;&#xa0;&#xa0;<span class="tag"><span class="homework">homework</span></span></a></li>
</ul>
</li>
<li><a href="#org0ecb409">2. Practice Simulating With DEs</a>
<ul>
<li><a href="#orgdd3d0a1">2.1. Frictionless Springs</a>
<ul>
<li><a href="#org6861d82">2.1.1. The equation of a frictionless spring?</a></li>
</ul>
</li>
<li><a href="#org3a91d14">2.2. Damped Oscillators&#xa0;&#xa0;&#xa0;<span class="tag"><span class="homework">homework</span></span></a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="outline-container-orgdb1d861" class="outline-2">
<h2 id="orgdb1d861"><span class="section-number-2">1.</span> An Introduction to Differential Equations</h2>
<div class="outline-text-2" id="text-1">
</div>
<div id="outline-container-orge390b34" class="outline-3">
<h3 id="orge390b34"><span class="section-number-3">1.1.</span> Why are Differential Equations an important technique for computational modelling in psychology and neuroscience?</h3>
<div class="outline-text-3" id="text-1-1">
</div>
<div id="outline-container-orga3aca2d" class="outline-4">
<h4 id="orga3aca2d"><span class="section-number-4">1.1.1.</span> The Action Potential&#xa0;&#xa0;&#xa0;<span class="tag"><span class="class_exercise">class_exercise</span></span></h4>
<div class="outline-text-4" id="text-1-1-1">
<ol class="org-ol">
<li>10 minutes to brush up on what an action potential is.</li>
<li>Then be able to draw one and explain,
<ol class="org-ol">
<li>What are the axes?</li>
<li>What ion causes the upward deflection?</li>
<li>What causes the repolarization?</li>
<li>Who discovered the action potential?</li>
<li>Who won the Nobel Prize for characterizing the ionic events
of the action potential experimentally and building a
mathematical model?</li>
</ol></li>
<li>Did you draw this?
<a href="https://commons.wikimedia.org/w/index.php?curid=44114666">https://commons.wikimedia.org/w/index.php?curid=44114666</a></li>
</ol>

<p>
<b>Why?</b> If we can reproduce this curve mathematically we will gain insight into the mechansims that apply to biological neurons, and we will gain a mathematical model we can use (or simplify for use) in artificial models. 
</p>
</div>
</div>

<div id="outline-container-orgf183b67" class="outline-4">
<h4 id="orgf183b67"><span class="section-number-4">1.1.2.</span> Why is the action potential relevant for a discussion of DE's in modelling?</h4>
<div class="outline-text-4" id="text-1-1-2">
<p>
The computational model of the action potential is a partial differential equation and action potentials, "spikes", are often taken to be the information processing unit of the nervous system.
</p>

<p>
DE's are the way we capture dynamics, how things change over time. If you think some neural or cognitive process that you are interested in is changing over time, then you are interested in dynamics and the first approach you should think of for modelling it is a differential equation.
</p>
</div>
</div>
</div>

<div id="outline-container-org267e055" class="outline-3">
<h3 id="org267e055"><span class="section-number-3">1.2.</span> Notation</h3>
<div class="outline-text-3" id="text-1-2">
<p>
Concise summaries of things that would take too long to write out in detail. Mathematical notation is just a technical emoji. You probably know the "math" they represent; you just don't know the abbreviation that is being used.
</p>

<p>
Write out in long hand (or type on your computer) what is meant by the
following:
</p>

<p>
\[\sum_{\forall x \in \left\{ 1 , 2 , 3 \right \}} x ~=~ 6\]
</p>
</div>
<div id="outline-container-org997c23a" class="outline-4">
<h4 id="org997c23a"><span class="section-number-4">1.2.1.</span> Multiple Ways to Say the Same Thing</h4>
<div class="outline-text-4" id="text-1-2-1">
<p>
\(\frac{dy}{dx}\)
</p>

<p>
\(\dot{x}\)
</p>

<p>
\(x'\)
</p>

<p>
\(f'(x)\)
</p>

<p>
Moral: Don't let weird symbols put you off trying to understand. Plenty of musical people can't understand a score. Just because you don't understand a mathematical score does not mean you don't understand the mathematics.
</p>
</div>
</div>
</div>

<div id="outline-container-org00ef11a" class="outline-3">
<h3 id="org00ef11a"><span class="section-number-3">1.3.</span> Differential Equations - Equations with Derivatives</h3>
<div class="outline-text-3" id="text-1-3">
</div>
<div id="outline-container-org9f43a0b" class="outline-4">
<h4 id="org9f43a0b"><span class="section-number-4">1.3.1.</span> What is a differential equation?</h4>
<div class="outline-text-4" id="text-1-3-1">
<p>
Give me an answer that uses <b>no</b> equations. Just words. 
</p>
</div>
</div>
<div id="outline-container-org378aa28" class="outline-4">
<h4 id="org378aa28"><span class="section-number-4">1.3.2.</span> What is a derivative?</h4>
<div class="outline-text-4" id="text-1-3-2">
<p>
Give me an answer that uses <b>no</b> equations. Just words. 
</p>
</div>
</div>
<div id="outline-container-orgb01c940" class="outline-4">
<h4 id="orgb01c940"><span class="section-number-4">1.3.3.</span> Derivatives are Slopes</h4>
<div class="outline-text-4" id="text-1-3-3">
<ol class="org-ol">
<li>What is a slope?</li>
<li>When in doubt return to definition.</li>
<li>Deriving the definition of a derivative.</li>
<li>What is the definition of a derivative?</li>
</ol>
</div>
</div>
<div id="outline-container-org62ae167" class="outline-4">
<h4 id="org62ae167"><span class="section-number-4">1.3.4.</span> Digression: Use your computer as a tool for exploration</h4>
<div class="outline-text-4" id="text-1-3-4">
<div class="org-src-container">
<pre class="src src-python" id="org17edca0">
<span style="color: #a020f0;">import</span> matplotlib
<span style="color: #a020f0;">import</span> matplotlib.pyplot <span style="color: #a020f0;">as</span> plt
<span style="color: #a020f0;">import</span> numpy <span style="color: #a020f0;">as</span> np
plt.clf()
<span style="color: #a0522d;">xs</span> = [1,2,3,4,5]
<span style="color: #a0522d;">ys</span> = [2,4,6,8,10]
plt.plot(xs,ys)
plt.savefig(<span style="color: #8b2252;">"./images/p_p.png"</span>)
</pre>
</div>


<div id="org0a83bba" class="figure">
<p><img src="./images/p_p.png" alt="p_p.png" />
</p>
<p><span class="figure-number">Figure 1: </span>A Simple Plot</p>
</div>
</div>
</div>

<div id="outline-container-orga5ebfca" class="outline-4">
<h4 id="orga5ebfca"><span class="section-number-4">1.3.5.</span> What is the Slope of a Curve?</h4>
<div class="outline-text-4" id="text-1-3-5">
<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 1: </span>Effective use of the computer as a tool means you should always be learning and trying new things. The be the next new thing, or it may be some great, old, forgotten thing. I want to learn Lisp. I am restyling some of the older examples as self-exercises.</label><pre class="src src-lisp" id="org135b12f">(ql:quickload <span style="color: #483d8b;">:eazy-gnuplot</span>)
(use-package <span style="color: #483d8b;">:eazy-gnuplot</span>) 
</pre>
</div>

<div class="org-src-container">
<pre class="src src-lisp">(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">scatter-plot</span> (output)
  (<span style="color: #a020f0;">let</span> ((point-max 100)
        (point-type 7)
        (point-color <span style="color: #8b2252;">"red"</span>)
        (step-size 1)
        (slope 0.4))
    (<span style="color: #a020f0;">with-plots</span> (*standard-output* <span style="color: #483d8b;">:debug</span> nil)
      (gp-setup <span style="color: #483d8b;">:terminal</span> '(pngcairo) <span style="color: #483d8b;">:output</span> output)
      (plot
       (<span style="color: #a020f0;">lambda</span> ()
         (<span style="color: #a020f0;">loop</span> for p from 1 upto point-max by step-size
                 do (format t <span style="color: #8b2252;">"~&amp;~a ~a"</span> p (+ (- p step-size) (* (- p step-size) slope)))))
       <span style="color: #483d8b;">:with</span> `(<span style="color: #483d8b;">:lines</span> <span style="color: #483d8b;">:lc</span> <span style="color: #483d8b;">:rgb</span> ,point-color <span style="color: #483d8b;">:title</span> <span style="color: #8b2252;">"Drawing a Line"</span>)))))
(scatter-plot <span style="color: #8b2252;">"./images/s-p.png"</span>)
</pre>
</div>


<div id="org830a8be" class="figure">
<p><img src="./images/s-p.png" alt="s-p.png" />
</p>
<p><span class="figure-number">Figure 2: </span>A line drawn with gnuplot called from common-lisp library "eazy-plot". Note the programmatic use of plot commands. Much harder to get started. Much greater control later on.</p>
</div>
</div>
</div>

<div id="outline-container-org139697d" class="outline-4">
<h4 id="org139697d"><span class="section-number-4">1.3.6.</span> Thinking About Slopes</h4>
<div class="outline-text-4" id="text-1-3-6">
<ol class="org-ol">
<li>Describe in words a reallife scenario that matches the process being
plotted above.</li>
<li>How would you define a slope for a curve like this?</li>
</ol>
</div>
</div>
<div id="outline-container-org78044bc" class="outline-4">
<h4 id="org78044bc"><span class="section-number-4">1.3.7.</span> How do you find the slope of a <i>curve</i>?</h4>
<div class="outline-text-4" id="text-1-3-7">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #a020f0;">from</span> matplotlib <span style="color: #a020f0;">import</span> pyplot
<span style="color: #a020f0;">import</span> matplotlib.pyplot <span style="color: #a020f0;">as</span> plt
<span style="color: #a020f0;">import</span> numpy <span style="color: #a020f0;">as</span> np
<span style="color: #a0522d;">a</span> = np.linspace(-4,6,num=120)
<span style="color: #a0522d;">b</span> = [x**3 <span style="color: #a020f0;">for</span> x <span style="color: #a020f0;">in</span> a];<span style="color: #b22222;">#</span><span style="color: #b22222;">list comprehension</span>
plt.clf()
plt.plot(a,b)
plt.plot([2,2],[-100,8], <span style="color: #8b2252;">'k-'</span>,lw=2)
plt.plot([-4,2],[8,8], <span style="color: #8b2252;">'k-'</span>,lw=2)
plt.plot([4,4],[64,-100], <span style="color: #8b2252;">'k-'</span>,lw=2)
plt.plot([-4,6],[-64,56], <span style="color: #8b2252;">'r-'</span>,lw=2)
plt.plot([-4,4],[64,64], <span style="color: #8b2252;">'k-'</span>,lw=2)
plt.plot([4,6],[64,64], <span style="color: #8b2252;">'k--'</span>,lw=2)
plt.plot([2,4],[8,64], <span style="color: #8b2252;">'k-'</span>,lw=2)
plt.savefig(<span style="color: #8b2252;">"./images/curve-slope.png"</span>)
</pre>
</div>


<div id="org99ca935" class="figure">
<p><img src="./images/curve-slope.png" alt="curve-slope.png" />
</p>
<p><span class="figure-number">Figure 3: </span>The slope of a curve illustrated. In this example I use a series of python commands and the python numpy library. There are many ways to get things done. Find one that works for you, and try to think about how to learn something that will serve you long into the future, and not just the tool that meets immediate needs.</p>
</div>
</div>
</div>
</div>

<div id="outline-container-org41404c0" class="outline-3">
<h3 id="org41404c0"><span class="section-number-3">1.4.</span> Derivatives are Instantaneous Slopes</h3>
<div class="outline-text-3" id="text-1-4">
<p>
You pick two points that are "close enough" and you get an answer that
is "close enough." If your answer isn't "close enough" then you move
your points closer, until <i>in the limit</i> there is an infinitesimal
distance between them.
</p>
</div>

<div id="outline-container-derivative" class="outline-4">
<h4 id="derivative"><span class="section-number-4">1.4.1.</span> Definition of the Derivative:</h4>
<div class="outline-text-4" id="text-derivative">
<p>
\[\frac{df}{dx} = \lim_{h \to 0}\frac{f(x + h) - f(x)}{(x + h) - x}\]
</p>
</div>
</div>

<div id="outline-container-orgb1ece74" class="outline-4">
<h4 id="orgb1ece74"><span class="section-number-4">1.4.2.</span> Digression: Writing Math in Documents</h4>
<div class="outline-text-4" id="text-1-4-2">
<p>
The current standard tool for nicely typeset math is LaTeX. You can use this in jupyter notebooks and even some in <a href="https://support.microsoft.com/en-us/office/linear-format-equations-using-unicodemath-and-latex-in-word-2e00618d-b1fd-49d8-8cb4-8d17f25754f8">Word</a>. However, the most powerful way is just to write the document as a simple text file with the .tex ending and use TeX post-processors. This is easiest in Linux, but isn't too hard for both Windows and OSX. Here I use LaTeX fragments in side an "org" file compiled by emacs using other programs on my computer.
</p>

<p>
<a href="https://faculty.math.illinois.edu/~hildebr/tex/latex-start.html">Some Resources</a>
</p>
</div>

<ol class="org-ol">
<li><a id="org01c3af3"></a>Using Derivatives to Solve Problems With a Computer<br />
<ol class="org-ol">
<li><a id="org3643b5b"></a>What is a square root?&#xa0;&#xa0;&#xa0;<span class="tag"><span class="class_exercise">class_exercise</span></span><br />
<div class="outline-text-6" id="text-1-4-2-1-1">
<p>
What is the <b>solution</b> to \(y=x^2\) if I tell you what \(y\) is?
</p>

<p>
Thinking about how to solve it. Some discussion questions:
</p>
<ol class="org-ol">
<li>Come up with a guess (e.g. in your head what would you guess is the
square root of 128?).</li>
<li>Write a formula that would allow you to compute the error (or how far
off you were).</li>
<li>How much should you adjust your guess to get closer to the correct
answer?</li>
<li>What is the derivative of \(x^2\)? Does it have a place in your
formula?</li>
<li>Give a reason graphically why you ought to be able to use this
derivative to help improve your guess.</li>
<li>What happens to the sign of the "adjustment" when our guesses go from
giving us too big an answer to too little an answer.</li>
</ol>
</div>
</li>
</ol>
</li>
<li><a id="orgc4891c6"></a>Analytical Solutions<br />
<div class="outline-text-5" id="text-1-4-2-2">
<p>
Let software be your guide.
</p>
<ol class="org-ol">
<li><a href="https://www.sympy.org/en/index.html">Sympy</a></li>
<li><a href="https://www.cfm.brown.edu/people/dobrush/am33/SymPy/index.html">Sympy for applied DEs</a></li>
<li><a href="https://cran.r-project.org/web/packages/Deriv/Deriv.pdf">R for Derivatives</a></li>
</ol>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 2: </span>What is the derivative of x squared?</label><pre class="src src-maxima" id="org9a3fcba">f(x) := x^2;
tex(diff (f(x), x));
</pre>
</div>

<p>
NB: As I am trying to learn a new computer language I tried a new tool in that language to help with learning. <a href="https://maxima.sourceforge.io/">Maxima</a> is a powerful computer algebra system. You do <b>not</b> have to know or use Lisp to use maxima, but it is written in Lisp and can be called from Lisp. 
</p>

<p>
\[2\,x\]
</p>
</div>
</li>


<li><a id="orgd49d877"></a>Working Through an Example<br />
<ol class="org-ol">
<li><a id="org8540c3c"></a>When in doubt, guess<br />
<div class="outline-text-6" id="text-1-4-2-3-1">
<ul class="org-ul">
<li><p>
How much is your guess off?
</p>

<p>
\(\mbox{Error} = \mbox{(my guess)}^2 - \mbox{128}\)
</p></li>

<li><p>
How much does the error change when the guess changes?
This is a derivative. A <b>rate of change</b>.
</p>

<p>
\(\frac{\Delta~\mbox{Error}}{\Delta~\mbox{Guess}} = \frac{\mbox{Error(Guess1) - Error(Guess0)}}{\mbox{Guess1} - \mbox{Guess0}}\)
</p>

<p>
As the guess gets very small this will approach the definition of the derivative.
</p></li>
</ul>

<p>
We have a function for how to compute the result of our guess and we can get the derivative of that either by hand or by using a computer algebra system.
</p>

<p>
\[\frac{\mbox{dError}}{\mbox{dGuess}} = \frac{\mbox{f(Guess1)} - \mbox{goal} - \mbox{f(Guess0)} + \mbox{goal}}{\mbox{Guess1} - \mbox{Guess0}}\]
</p>


<ul class="org-ul">
<li>Using these relations can we come up with a formula for how much we need to adjust our guess based on how big the error was?</li>
</ul>


<div class="org-src-container">
<pre class="src src-python"><span style="color: #b22222;">#</span><span style="color: #b22222;">Error Plot</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">What is square root of 55?</span>
<span style="color: #a0522d;">plotData</span> = [(x**2-55,x) <span style="color: #a020f0;">for</span> x <span style="color: #a020f0;">in</span> np.arange(5.0,8.5,0.01)]
plt.clf()
plt.plot([y[1] <span style="color: #a020f0;">for</span> y <span style="color: #a020f0;">in</span> plotData],[x[0] <span style="color: #a020f0;">for</span> x <span style="color: #a020f0;">in</span> plotData],)
plt.plot([5.0,8.5],[0,0],<span style="color: #8b2252;">'r-'</span>)
plt.plot([np.sqrt(55),np.sqrt(55)],[12,-30],<span style="color: #8b2252;">'r-'</span>)
plt.plot([5.0,8.0],[-30,0],<span style="color: #8b2252;">'k--'</span>)
plt.plot([8.0,8.0],[-5,15],<span style="color: #8b2252;">'g--'</span>)
plt.plot([8.0,8.0-(9.0/16)] , [9.0,0.0],<span style="color: #8b2252;">'b'</span>)
plt.savefig(<span style="color: #8b2252;">"./images/sqrt55.png"</span>)
</pre>
</div>


<div id="orgb7ba93b" class="figure">
<p><img src="./images/sqrt55.png" alt="sqrt55.png" />
</p>
<p><span class="figure-number">Figure 4: </span>Slopes for Curves</p>
</div>


<div class="org-src-container">
<pre class="src src-python">
<span style="color: #a0522d;">plotData</span> = [(x**2-55,x) <span style="color: #a020f0;">for</span> x <span style="color: #a020f0;">in</span> np.arange(7.3,7.6,0.01)]
plt.clf()
plt.plot([y[1] <span style="color: #a020f0;">for</span> y <span style="color: #a020f0;">in</span> plotData],[x[0] <span style="color: #a020f0;">for</span> x <span style="color: #a020f0;">in</span> plotData],)
plt.plot([7.0,7.5],[0,0],<span style="color: #8b2252;">'r-'</span>)
plt.plot([np.sqrt(55),np.sqrt(55)],[3,-3],<span style="color: #8b2252;">'r-'</span>)
<span style="color: #a0522d;">xs</span> = [np.sqrt(55)-1/4,np.sqrt(55)+1/4]
plt.plot(xs , [16*x-119 <span style="color: #a020f0;">for</span> x <span style="color: #a020f0;">in</span> xs],<span style="color: #8b2252;">'b'</span>)
plt.savefig(<span style="color: #8b2252;">"./images/sqrt-more.png"</span>)
</pre>
</div>


<div id="org228540f" class="figure">
<p><img src="./images/sqrt-more.png" alt="sqrt-more.png" />
</p>
</div>
</div>
</li>
</ol>
</li>

<li><a id="finding-cube-roots"></a>Finding Cube Roots&#xa0;&#xa0;&#xa0;<span class="tag"><span class="class_exercise">class_exercise</span></span><br />
<div class="outline-text-5" id="text-finding-cube-roots">
<ol class="org-ol">
<li>What is a <i>cube root</i>?</li>

<li>What is the derivative of \(x^3\)?</li>

<li>Find it with a computer algebra system <b>even if you know how to do it by hand.</b>
A simple way to make sure you are on the right track with a new programming tool is to do something in code that you can do in your head or on paper to make sure that you get the correct answer. It does not substitute for <a href="https://realpython.com/python-testing/">proper testing</a>, but it is an easy to do start. You don't want to waste time trying to perfect a flawed approach.</li>

<li>Write two Python Functions: one to <code>return</code> the cube of a number, and
one to <code>return</code> the derivative when evaluated at a particular value
of <code>x</code>.</li>
</ol>

<div class="org-src-container">
<pre class="src src-maxima">f(x) := x^3;
df:diff(f(x), x);
tex(df);
newline();
print("The derivative of x^3 at 3 is: ",ev(df,x=3));
</pre>
</div>
<p>
\[3\,x^2\]
The derivative of x<sup>3</sup> at 3 is:  27 
</p>



<div class="org-src-container">
<pre class="src src-lisp">(setq *read-default-float-format* 'DOUBLE-FLOAT)
(<span style="color: #a020f0;">defvar</span> <span style="color: #a0522d;">*goal*</span> 128.0)
(<span style="color: #a020f0;">defvar</span> <span style="color: #a0522d;">*initial-guess*</span> 5.0)
(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">x-cubed</span> (x) (* x x x))
(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">diff-x-cubed</span> (x) (* 3 x x))
</pre>
</div>

<div class="org-src-container">
<pre class="src src-lisp">(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">get-step</span> (guess <span style="color: #228b22;">&amp;optional</span> (goal *goal*)) (/ (- goal (x-cubed guess)) (diff-x-cubed guess)))
</pre>
</div>

<p>
NB: I am using optional arguments so that when I use my functions I don't have to keep typing in common things that rarely change. You can do this in <a href="https://realpython.com/python-optional-arguments/">python</a> and <a href="https://www.oreilly.com/library/view/the-r-book/9780470510247/ch002-sec060.html">R</a> as well.
</p>

<div class="org-src-container">
<pre class="src src-lisp">(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">get-cube-root</span> (goal initial-guess <span style="color: #228b22;">&amp;optional</span> (tolerance 0.001))
  (<span style="color: #a020f0;">loop</span>
    for error = (get-step initial-guess goal) then (get-step new-guess goal)
    for new-guess = (+ initial-guess error) then (+ error new-guess)
    while ( &gt; (abs ( - (x-cubed new-guess) goal )) tolerance )
    do (format t <span style="color: #8b2252;">"new-guess is ~,15f~%"</span> new-guess)
    finally (<span style="color: #a020f0;">return</span> new-guess)))
</pre>
</div>

<p>
NB: My solution uses a <b>loop</b>. To emulate this approach you will need to discover how to write loops in your chosen language. The two main kinds of loops are <code>for</code> loops and <code>while</code> loops. Which one have I used above?
</p>

<div class="org-src-container">
<pre class="src src-lisp"><span style="color: #b22222;">;; </span><span style="color: #b22222;">let's try it out</span>
(get-cube-root 128 5.0)
</pre>
</div>
</div>
</li>
</ol>
</div>
</div>



<div id="outline-container-orgc4ffdc6" class="outline-3">
<h3 id="orgc4ffdc6"><span class="section-number-3">1.5.</span> Homework&#xa0;&#xa0;&#xa0;<span class="tag"><span class="homework">homework</span></span></h3>
<div class="outline-text-3" id="text-1-5">
<p>
Submit your program for computing the fourth root of a number. That is the number that when multiplied together four times equals the goal. For example \(2\times 2 \times 2 \times 2 ~ = 16\). If I gave you 16, your program ought to put out something close to 2. You should need to make very few changes to what you have already written to have a working program.
</p>

<p>
If this comes easy to you consider doing this <b>bonus</b> assignment. Have your program work for any root. That is I can give it goal and 'n' and it will calculate the \(n^{th}\) root. For example <code>(nth-root 16 2)</code> gives me four, but <code>(nth-root 16 4)</code> gives me two.
</p>
</div>
</div>
</div>


<div id="outline-container-org0ecb409" class="outline-2">
<h2 id="org0ecb409"><span class="section-number-2">2.</span> Practice Simulating With DEs</h2>
<div class="outline-text-2" id="text-2">
</div>
<div id="outline-container-orgdd3d0a1" class="outline-3">
<h3 id="orgdd3d0a1"><span class="section-number-3">2.1.</span> Frictionless Springs</h3>
<div class="outline-text-3" id="text-2-1">
<p>
Motivation: I know we want to code neurons, but to get there we should feel comfortable with the underlying tool or we won't be able to adapt it or re-use it for some new purpose. I don't want to give you a fish. I want to teach you how to fish.
</p>

<p>
By working with an example simpler than a neuron, and one for which you might have more intuition, such as a simple spring or "slinky" I hope you will get a better <i>feel</i> for how the numbers, equations, and code all relate. Then we can move on to the neuronal application.
</p>
</div>

<div id="outline-container-org6861d82" class="outline-4">
<h4 id="org6861d82"><span class="section-number-4">2.1.1.</span> The equation of a frictionless spring?</h4>
<div class="outline-text-4" id="text-2-1-1">
\begin{equation}
\label{eq:1}
\frac{d^2 s}{dt^2} = -P~s(t)
\end{equation}


<p>
What does it mean? What is multiplying what here? What do the parentheses mean, and how do you know what they mean? 
</p>
</div>

<ol class="org-ol">
<li><a id="org074076d"></a>How do we finesse the derivatives?<br />
<div class="outline-text-5" id="text-2-1-1-1">
<p>
Use definitions <a href="#derivative">1.4.1</a>.
</p>

<p>
Imagine a little time has gone by (\(\Delta~t\)). What is our new position (\(s\) is for space)?
</p>

<p>
\[\frac{s(t + \Delta t) - s(t)}{\Delta t} = velocity \approx \frac{d s}{d t}\].
</p>

<p>
What is our initial velocity? Assume zero.
</p>

<p>
How will our velocity change with time?
</p>

<p>
\[\frac{v(t + \Delta t) - v(t)}{\Delta t} = acceleration \approx \frac{d v}{d t} = \frac{d^2 s}{d t^2}\]
</p>

<p>
And we have a formula for this. We can now bootstrap our simulation.
</p>

<div class="org-src-container">
<pre class="src src-lisp" id="orgc8fd7a4">(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">s-of-t</span> (delta-t v s)
  (+ s (* v delta-t)))

(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">v-of-t</span> (delta-t a v)
  (+ v (* a delta-t)))

(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">a-of-t</span> (p s)
  (* -1 p s))
</pre>
</div>


<p>
Note the similiarity of the two functions. You could write a helper function that was generic to this pattern of old value + rate of change times the  time step, and just used the pertinent values. 
</p>

<p>
How do we know the formula for acceleration? We were given it \ref{eq:1}. 
</p>

<div class="org-src-container">
<pre class="src src-lisp" id="org4063378"><span style="color: #b22222;">;; </span><span style="color: #b22222;">generating initial values and variables</span>
(<span style="color: #a020f0;">defconstant</span> <span style="color: #a0522d;">+init-v+</span> 0
  <span style="color: #8b2252;">"The initial Velocity"</span>)
(<span style="color: #a020f0;">defconstant</span> <span style="color: #a0522d;">+init-s+</span> 10)
(<span style="color: #a020f0;">defconstant</span> <span style="color: #a0522d;">+p+</span> 2)
(<span style="color: #a020f0;">defconstant</span> <span style="color: #a0522d;">+delta-t+</span> 0.05)
</pre>
</div>

<p>
NB: you should consider doing something similar with your code. Put all the numbers and values you don't expect to change very much in a block at the top of your code. Then refer to them by their variable names later on. This is much more convenient if you want to change or update something. You have one spot to look to find the value to change. Changing it in one place propagates through all the rest of your code. 
</p>

<p>
NB: I give an example of a "doc string". Most programming languages have a way of adding documentation. It is much nicer to add this as you write your code than to go in at the end and try to do it all at once. Try to use short simple, but <b>meaningful</b>, variable names and give longer explanations as documentation.
</p>

<div class="org-src-container">
<pre class="src src-lisp" id="orgaa5bedb">(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">release-spring</span> (<span style="color: #228b22;">&amp;optional</span> (repeat-n 5))
  (<span style="color: #a020f0;">loop</span>
    repeat repeat-n
    for a = (a-of-t +p+ +init-s+)         then (a-of-t +p+ s)
    for v = +init-v+                      then (v-of-t +delta-t+ a v)
    for s = +init-s+                      then (s-of-t +delta-t+ v s)
    for time = 0                          then (+ time +delta-t+)
    collect (list a v s time)))
</pre>
</div>

<p>
NB: The code above creates a series of steps that happen one after the other. This is <b>not</b> a nested loop, though it will look similar to the nesting of loops you can see in python and R. This is just a common lisp idiosyncrasy. You will again need to use a loop. This time I am using what kind of loop? The <code>collect</code> statement is a short hand for gathering all my values up and returing them. You will probably need something like a <code>return</code> statement or a variable that you use to catch the updated values and append them on to a growning list. 
</p>

<div class="org-src-container">
<pre class="src src-lisp" id="orgf1680b7">(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">spring-plot</span> (output)
  (<span style="color: #a020f0;">let</span> ((data (mapcar (<span style="color: #a020f0;">lambda</span> (a) (cons (fourth a) (third a))) (release-spring 1000)))
        (point-type 7)
        (point-color <span style="color: #8b2252;">"red"</span>)
        (step-size 1)
        (slope 0.4))
    (<span style="color: #a020f0;">with-plots</span> (*standard-output* <span style="color: #483d8b;">:debug</span> nil)
      (gp-setup <span style="color: #483d8b;">:output</span> output <span style="color: #483d8b;">:terminal</span> '(<span style="color: #483d8b;">:pngcairo</span>) <span style="color: #483d8b;">:title</span>
            <span style="color: #8b2252;">"Frictionless Spring"</span> <span style="color: #483d8b;">:xlabel</span> <span style="color: #8b2252;">"Time (sec.)"</span>
            <span style="color: #483d8b;">:ylabel</span> <span style="color: #8b2252;">"Location"</span> <span style="color: #483d8b;">:key</span> '(box lt -1 lw 2 opaque))
      (plot
       (<span style="color: #a020f0;">lambda</span> ()
         (<span style="color: #a020f0;">loop</span> for p in data
                 do (format t <span style="color: #8b2252;">"~&amp;~a ~a"</span> (car p) (cdr p))))
       <span style="color: #483d8b;">:with</span> `(<span style="color: #483d8b;">:lines</span> <span style="color: #483d8b;">:lc</span> <span style="color: #483d8b;">:rgb</span> ,point-color <span style="color: #483d8b;">:title</span> <span style="color: #8b2252;">"Location"</span>)))))
(spring-plot <span style="color: #8b2252;">"./images/spring.png"</span>)
</pre>
</div>
</div>
</li>

<li><a id="orgc95ea6e"></a>Do you understand the logic of the code?&#xa0;&#xa0;&#xa0;<span class="tag"><span class="class_exercise">class_exercise</span></span><br />
<div class="outline-text-5" id="text-2-1-1-2">
<p>
You may see examples of <span class="underline">pseudo-code</span> in the future. This is when an algorithm is described as if it were a computer program. You are told the steps that need to happen and the order, but often it is not in any particular language, but just a general sort-of kind-of like code code. It is good to practice reading code like that so that you can more easily translate the procedures and steps into the language you like to use.
</p>

<p>
The "mapcar" you see is a lisp version of <code>map</code>. This is a common <i>functional programming</i> construct that is very powerful and lets you write concise code that achieves loop like behavior in a simpler fashion. Less writing means less chances for bugs in your code, and more concise code makes it easier for people to read and understand your code. See if you can find the <code>map</code> equivalent for the language you are programming in and see if you can get it to work here. The usual procedure is to get something working first, and then try to amend it to use the new tool or technique. 
</p>


<div id="org0156b1e" class="figure">
<p><img src="./images/spring.png" alt="spring.png" />
</p>
</div>
</div>
</li>
</ol>
</div>
</div>



<div id="outline-container-org3a91d14" class="outline-3">
<h3 id="org3a91d14"><span class="section-number-3">2.2.</span> Damped Oscillators&#xa0;&#xa0;&#xa0;<span class="tag"><span class="homework">homework</span></span></h3>
<div class="outline-text-3" id="text-2-2">
<p>
Provide the code for the damped oscillator. It has the formula of
</p>

<p>
\[ \frac{d^2 s}{dt^2} = -P~s(t) - k~v(t) \]
</p>

<p>
This should really only require changing one line of your code for the
simple harmonic oscillator.
</p>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="author">Author: Britt Anderson</p>
<p class="date">Created: 2021-12-27 Mon 14:22</p>
<p class="validation"><a href="https://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
